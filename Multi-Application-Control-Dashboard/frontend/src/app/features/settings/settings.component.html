<div class="space-y-6">
  <!-- Header -->
  <h1 class="text-3xl font-bold text-gray-900">âš™ï¸ Settings</h1>

  <!-- Success Message -->
  @if(successMessage){
  <div class="p-4 bg-green-50 border border-green-200 rounded-lg text-green-700">
    âœ“ {{ successMessage }}
  </div>
  }

  <!-- Settings Card -->
  <div class="bg-white rounded-lg shadow-md p-8 max-w-2xl">
    <form [formGroup]="settingsForm" (ngSubmit)="onSubmit()">
      <!-- Theme Preference -->
      <div class="mb-6 pb-6 border-b border-gray-200">
        <label class="block text-gray-700 font-semibold mb-3">ğŸ¨ Theme</label>
        <div class="space-y-2">
          <label class="flex items-center">
            <input 
              type="radio" 
              formControlName="theme" 
              value="light" 
              appAuthDisabled="Settings" 
              appAuthDisabledAction="edit"
              class="mr-2">
            <span class="text-gray-700">Light Mode</span>
          </label>
          <label class="flex items-center">
            <input 
              type="radio" 
              formControlName="theme" 
              value="dark" 
              appAuthDisabled="Settings" 
              appAuthDisabledAction="edit"
              class="mr-2">
            <span class="text-gray-700">Dark Mode</span>
          </label>
        </div>
      </div>

      <!-- Notifications -->
      <div class="mb-6 pb-6 border-b border-gray-200">
        <label class="flex items-center justify-between">
          <span class="text-gray-700 font-semibold">ğŸ”” In-App Notifications</span>
          <input 
            type="checkbox" 
            formControlName="notifications" 
            appAuthDisabled="Settings" 
            appAuthDisabledAction="edit"
            class="toggle">
        </label>
        <p class="text-sm text-gray-600 mt-2">Receive notifications for important updates</p>
      </div>

      <!-- Email Notifications -->
      <div class="mb-6 pb-6 border-b border-gray-200">
        <label class="flex items-center justify-between">
          <span class="text-gray-700 font-semibold">ğŸ“§ Email Notifications</span>
          <input 
            type="checkbox" 
            formControlName="emailNotifications" 
            appAuthDisabled="Settings" 
            appAuthDisabledAction="edit"
            [disabled]="emailNotificationsDisabled"
            class="toggle">
        </label>
        <p class="text-sm text-gray-600 mt-2">Receive email notifications for system events</p>
        @if(emailNotificationsDisabled){
          <p class="text-sm text-orange-600 mt-1">Enable in-app notifications first</p>
        }
      </div>

      <!-- Two-Factor Authentication - Role Restricted -->
      <div *appHasPermission="'Settings'; action: 'manage-security'" class="mb-6 pb-6 border-b border-gray-200">
        <label class="flex items-center justify-between">
          <span class="text-gray-700 font-semibold">ğŸ” Two-Factor Authentication</span>
          <input 
            type="checkbox" 
            formControlName="twoFactorAuth" 
            appAuthDisabled="Settings" 
            appAuthDisabledAction="edit"
            class="toggle">
        </label>
        <p class="text-sm text-gray-600 mt-2">Add extra security to your account</p>
      </div>

      <!-- Data Collection -->
      <div class="mb-6">
        <label class="flex items-center justify-between">
          <span class="text-gray-700 font-semibold">ğŸ“Š Data Collection</span>
          <input 
            type="checkbox" 
            formControlName="dataCollection" 
            appAuthDisabled="Settings" 
            appAuthDisabledAction="edit"
            class="toggle">
        </label>
        <p class="text-sm text-gray-600 mt-2">Allow us to collect usage data for improvements</p>
      </div>

      <!-- Admin-Only Settings -->
      <div *appHasRole="[RoleType.SUPER_ADMIN, RoleType.ADMIN]" class="mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200">
        <h3 class="font-semibold text-blue-800 mb-3">Administrator Settings</h3>
        <p class="text-sm text-blue-600">Advanced settings available only to administrators</p>
      </div>

      <!-- Buttons -->
      <div class="flex space-x-4 pt-6">
        <button 
          type="submit" 
          [disabled]="loading || !('Settings' | hasPermission:'edit')"
          appAuthDisabled="Settings" 
          appAuthDisabledAction="edit"
          class="btn-primary">
          {{ loading ? 'Saving...' : 'Save Settings' }}
        </button>
        
        <button 
          type="button" 
          (click)="changePassword()" 
          [disabled]="!('Settings' | hasPermission:'edit-password')"
          class="btn-secondary">
          ğŸ”‘ Change Password
        </button>
        
        <button 
          type="button" 
          (click)="resetToDefaults()"
          *appHasRole="[RoleType.SUPER_ADMIN]"
          class="btn-danger">
          ğŸ”„ Reset to Defaults
        </button>
      </div>
    </form>
  </div>

  <!-- Role-specific notices -->
  <div *appHasRole="[RoleType.VIEWER]" class="p-4 bg-gray-50 border border-gray-200 rounded-lg">
    <h3 class="font-semibold text-gray-800">Viewer Mode</h3>
    <p class="text-gray-600 text-sm">You have read-only access. Some settings are not available.</p>
  </div>

  <div *appHasRole="[RoleType.NORMAL_USER]" class="p-4 bg-green-50 border border-green-200 rounded-lg">
    <h3 class="font-semibold text-green-800">User Account</h3>
    <p class="text-green-600 text-sm">Manage your personal account settings and preferences.</p>
  </div>
</div>